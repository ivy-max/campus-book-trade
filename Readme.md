# 校园二手书籍交易平台

本项目是一个面向高校师生的二手书籍交易平台，包含微信小程序前端和 Django + MySQL 后端。平台支持书籍发布、分类浏览、订单管理、消息通知、用户信用分等功能，致力于为校园用户提供安全、便捷的二手书交易体验。

---

## 目录结构

```
miniprogram-6 4/                # 项目根目录
│
├── Campus-Book-Trade/          # 后端 Django 项目
│   ├── books/                  # 书籍相关后端模块
│   ├── chats/                  # 聊天相关后端模块
│   ├── notifications/          # 通知相关后端模块
│   ├── order/                  # 订单相关后端模块
│   ├── user_collections/       # 用户收藏相关后端模块
│   ├── users/                  # 用户相关后端模块
│   ├── campus_book_trade/      # Django 主配置
│   ├── sql/                    # 数据库建表、触发器、初始化脚本
│   └── media/                  # 用户上传的图片、头像等
│
├── api/                        # 小程序端API请求封装
├── assets/                     # 小程序端静态资源
├── config/                     # 小程序端配置
├── mock/                       # 小程序端mock数据
├── order/                      # 小程序端订单相关页面
├── orderList/                  # 小程序端订单列表页面
├── pages/                      # 小程序端各功能页面
├── utils/                      # 小程序端工具函数
├── typings/                    # 小程序端类型定义
├── app.js/json/wxss            # 小程序全局配置
├── package.json                # 小程序依赖
└── ...                         # 其他配置文件
```

---

## 快速开始

### 1. 后端（Django）

#### 环境准备
- Python 3.8+
- MySQL 5.7/8.0
- 推荐使用虚拟环境（如 venv）

#### 安装依赖
```bash
cd Campus-Book-Trade
pip install -r requirements.txt
```

#### 数据库初始化
1. 创建数据库（如 `campus_book_trade`），并导入 `sql/` 目录下的建表脚本（顺序建议）：
   - `create_users_table.sql`
   - `create_books_table.sql`
   - `create_order_table.sql`
   - `create_collections_table.sql`
   - `create_notifications_table.sql`
   - `create_chats_table.sql`
   - `create_triggers.sql`
2. 可选：运行 `setup_database.py` 进行自动化初始化。

#### 启动后端服务
```bash
python manage.py runserver
```
默认端口为 `8000`，API 根路径为 `http://127.0.0.1:8000/`

---

### 2. 前端（微信小程序）

#### 环境准备
- 微信开发者工具
- Node.js（如需本地依赖管理）

#### 运行步骤
1. 用微信开发者工具打开项目根目录。
2. 配置 `app.json`、`project.config.json` 等小程序参数。
3. 如需本地调试API，确保后端服务已启动并允许跨域。

---

## 主要功能

- **用户系统**：微信一键登录、个人信息、信用分管理
- **书籍管理**：书籍发布、分类、搜索、详情
- **订单系统**：下单、支付、评价、订单状态流转
- **消息通知**：系统消息、订单消息、聊天消息
- **信用分机制**：自动触发器计算、日志记录、等级划分
- **收藏与历史**：用户收藏、浏览历史

---

## 数据库说明

- 所有建表、触发器、存储过程SQL均在 `Campus-Book-Trade/sql/` 目录下
- 触发器和存储过程用于自动计算和维护用户信用分
- 重要表：`users`、`books_book`、`order_order`、`credit_calculation_log`、`trigger_debug_log`
- 如有表结构调整，请同步更新 SQL 脚本和 Django models

---

## 贡献与反馈

如有建议、Bug反馈或贡献代码，请提交 Issue 或 Pull Request。

---

## License

本项目仅供学习交流使用，禁止用于商业用途。

---

## 页面需求说明（原文保留）

做一个校内二手书籍交易小程序，包含二手商城、分类、消息、个人中心四个页面。每个页面的具体页面需求如下：

### 一、二手商城页面
- 书籍展示卡片：二手商城首页要显示书籍的价格（点进去之后要显示书籍出版社、作者、ISBN、新旧程度、详情等）
- 搜索功能：搜索框位于书籍展示卡片上方，搜索框需要支持模糊搜索，需要提供筛选选项，按校区筛选
- 发布书籍资料功能：在二手商城页面的下方正中间有一个加号，点击加号后，需要弹出一个表单页面，填写书籍的详细信息，包括图片上传
- 公告栏：位于搜索框上方，需要支持管理员发布公告，或者显示一些交易规则、注意事项

### 二、分类页面
- 包括书籍或资料分类、校区分类（邯郸校区、枫林校区、江湾校区、张江校区）、专业分类（专业书籍、思政、英语，专业书籍又包括经济、管理、大数据等）；每个分类点进去之后才会看到具体的书籍资料。要支持多分类筛选。

### 三、消息页面
1. 对话沟通：支持买卖双方发送图片和文字，关联商品，显示对话阅读状态，支持消息已读回执。
2. 系统消息：包括交易状态更新、评价通知、系统公告等，支持消息推送和历史消息查询。

### 四、个人中心页面
- 个人信息修改：支持修改头像、昵称、信用评分、密码、绑定手机号等功能。
- 查看订单：订单状态包括待付款、待发货、已发货、已完成等。用户还可以进行订单评价。
- 我的收藏：支持对收藏的书籍进行排序，如按添加时间、价格等。
- 信用评分：显示信用评分的详细计算方式和提升信用评分的建议。
